{
    "contents" : "require (ggplot2)\n\ndata(ToothGrowth)\n\nToothGrowth$dose <- as.factor(ToothGrowth$dose)\nnames(ToothGrowth) <- c(\"Len\", \"Supp\", \"Dose\")\nsupplements <- c(\"Orange Juice\", \"Vitamin C\")\n\nbyDose <- as.data.frame(t(\n  sapply(unique(as.character(ToothGrowth$Dose)), \n         function(Dose) data.frame(Mean=round(mean(ToothGrowth$Len[ToothGrowth$Dose==Dose]), 2), \n                                   StdDev=round(sd(ToothGrowth$Len[ToothGrowth$Dose==Dose]), 2),\n                                   N=as.numeric(sum(ToothGrowth$Dose==Dose)),\n                                   LowerConfidenceInterval=round(mean(ToothGrowth$Len[ToothGrowth$Dose==Dose]) - qt(0.975, df=sum(ToothGrowth$Dose==Dose)-1) * sd(ToothGrowth$Len[ToothGrowth$Dose==Dose]) / sqrt(sum(ToothGrowth$Dose==Dose)), 2), \n                                   UpperConfidenceInterval=round(mean(ToothGrowth$Len[ToothGrowth$Dose==Dose]) + qt(0.975, df=sum(ToothGrowth$Dose==Dose)-1) * sd(ToothGrowth$Len[ToothGrowth$Dose==Dose]) / sqrt(sum(ToothGrowth$Dose==Dose)), 2)\n         ))\n))\n\nbySupplement <- as.data.frame(t(\n  sapply(unique(as.character(ToothGrowth$Supp)), \n         function(Supplement) data.frame(Mean=round(mean(ToothGrowth$Len[ToothGrowth$Supp==Supplement]), 2), \n                                         StdDev=round(sd(ToothGrowth$Len[ToothGrowth$Supp==Supplement]), 2),\n                                         N=as.numeric(sum(ToothGrowth$Supp==Supplement)),\n                                         LowerConfidenceInterval=round(mean(ToothGrowth$Len[ToothGrowth$Supp==Supplement]) - qt(0.975, df=sum(ToothGrowth$Supp==Supplement)-1) * sd(ToothGrowth$Len[ToothGrowth$Supp==Supplement]) / sqrt(sum(ToothGrowth$Supp==Supplement)), 2), \n                                         UpperConfidenceInterval=round(mean(ToothGrowth$Len[ToothGrowth$Supp==Supplement]) + qt(0.975, df=sum(ToothGrowth$Supp==Supplement)-1) * sd(ToothGrowth$Len[ToothGrowth$Supp==Supplement]) / sqrt(sum(ToothGrowth$Supp==Supplement)), 2)\n         ))\n))\n\ng <- ggplot(ToothGrowth, aes(rep(1:(length(Len)/2), 2), Len, colour=Dose)) + \n     geom_point(size = 3) + \n     facet_grid(. ~ Supp, labeller=function(var, value) supplements[value]) + \n     scale_x_discrete(name=\"\", labels=\"\") +\n     scale_y_discrete(name=\"Tooth Length\")\n\nrownames(bySupplement) <- c(\"Vitamin C\", \"Orange Juice\")\n\n\nprint(g)\nprint(byDose)\nprint(bySupplement)\n\nVitaminC <- bySupplement[\"Vitamin C\",]\nOrangeJuice <- bySupplement[\"Orange Juice\",]\n\nsp <- sqrt(((VitaminC$N[[1]]-1)*VitaminC$StdDev[[1]]^2+(OrangeJuice$N[[1]]-1)*OrangeJuice$StdDev[[1]]^2) / (VitaminC$N[[1]] + OrangeJuice$N[[1]] - 2))\nci <- OrangeJuice$Mean[[1]] - VitaminC$Mean[[1]] + c(-1, 1) * qt(0.975, VitaminC$N[[1]] + OrangeJuice$N[[1]] - 2) * sp * sqrt(1 / VitaminC$N[[1]] + 1 / OrangeJuice$N[[1]])\nprint(ci)\n\nLowestDose <- byDose[1,]\nMediumDose <- byDose[2,]\nHighestDose <- byDose[3,]\n\nsp <- sqrt(((HighestDose$N[[1]]-1)*HighestDose$StdDev[[1]]^2+(LowestDose$N[[1]]-1)*LowestDose$StdDev[[1]]^2) / (HighestDose$N[[1]] + LowestDose$N[[1]] - 2))\nci <- HighestDose$Mean[[1]] - LowestDose$Mean[[1]] + c(-1, 1) * qt(0.975, HighestDose$N[[1]] + LowestDose$N[[1]] - 2) * sp * sqrt(1 / HighestDose$N[[1]] + 1 / LowestDose$N[[1]])\nprint(ci)\n\nsp <- sqrt(((HighestDose$N[[1]]-1)*HighestDose$StdDev[[1]]^2+(MediumDose$N[[1]]-1)*MediumDose$StdDev[[1]]^2) / (HighestDose$N[[1]] + MediumDose$N[[1]] - 2))\nci <- HighestDose$Mean[[1]] - MediumDose$Mean[[1]] + c(-1, 1) * qt(0.975, HighestDose$N[[1]] + MediumDose$N[[1]] - 2) * sp * sqrt(1 / HighestDose$N[[1]] + 1 / MediumDose$N[[1]])\nprint(ci)\n\n",
    "created" : 1410472828742.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2114353903",
    "id" : "9DA0A196",
    "lastKnownWriteTime" : 1410549764,
    "path" : "~/GitHub/StaticalInference3/Part2.R",
    "project_path" : "Part2.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : true,
    "type" : "r_source"
}